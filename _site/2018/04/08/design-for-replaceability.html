<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>Design for replaceability</title>
	
	<link rel="canonical" href="http://0.0.0.0:4000/2018/04/08/design-for-replaceability.html"/>
	
	<link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css" />
	<link rel="stylesheet" href="/css/syntax.css" type="text/css" />
	<link rel="stylesheet" href="/css/schwab.css" type="text/css" />
	<link rel="stylesheet" href="/css/print.css" media="print" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans+Condensed|Sansita:700|Zilla+Slab" rel="stylesheet">
	
	<link rel="alternate" type="application/rss+xml" title="Stephan Schwab" href="/rss.xml"/>

	<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>
	<script type='text/javascript' src='/unitegallery/js/unitegallery.min.js'></script> 
		
	<link rel='stylesheet' href='/unitegallery/css/unite-gallery.css' type='text/css' /> 
	<script type='text/javascript' src='/unitegallery/themes/tiles/ug-theme-tiles.js'></script> 

	<meta property="og:title" content="Design for replaceability">
	<meta property="twitter:title" content="Design for replaceability">
	<meta property="og:description" content="">
	<meta property="twitter:description" content="">
	<meta property="og:type" content="article">
	<meta property="og:url" content="http://0.0.0.0:4000/2018/04/08/design-for-replaceability.html">
	<meta property="twitter:card" content="summary_large_image">
	<meta property="twitter:site" content="@snscaimito">
	
</head>


<body>
	<div class="container">
		<div class="header no-print">
  <div class="menu">
    <a href="/">Home</a>
    <a href="/category/software_development.html">Software</a>
    <a href="/category/farm-life.html">Farm Life</a>
    <a href="/category/Business.html">Business</a>
    <a href="/category/aviation.html">Aviation</a>
  </div>
  <div class="claim-box">
    <p class="claim">Tales about Aviation, Coaching, Farming, Software Development</p>
  </div>
</div>
		<div class="row">
			<div class="span9">
				<div class="post">
					<h1>Design for replaceability</h1>
          
<div class="ale_news_post_header">
	<p>This blog post is part of a series. You might want to read the <a href="/2018/04/02/considerations-for-a-farm-following-the-principles-of-lean-startup.html">introductory article</a> or see an overview of all the articles in the series below.</p>
</div>

<p>The special thing about my application is that it is not really an application per se - at least not a single one. It’s more of a compound thing that gets assembled at <em>the edge</em>. The edge in this case is the edge of the network and happens to be the webbrowser of the user. You could also say that that is where the integration happens.</p>

<p>As of now I have three SCS applications that provide their own user interface and a total of six running containers.</p>

<p>Here is the output of <code>docker ps</code> at the time my application is running:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CONTAINER ID        IMAGE                        COMMAND                  CREATED             STATUS              PORTS                    NAMES
04d888f2511a        nginx                        "nginx -g 'daemon of…"   2 weeks ago         Up 26 hours         0.0.0.0:80-&gt;80/tcp       farmmealplanner_frontend_1
b46ccf41cd6a        farmmealplanner_cookbooks    "java -Djava.securit…"   2 weeks ago         Up 26 hours         8080/tcp                 farmmealplanner_cookbooks_1
89e4532ae1fe        farmmealplanner_navigation   "java -Djava.securit…"   2 weeks ago         Up 26 hours         8080/tcp                 farmmealplanner_navigation_1
9a2203ca4d1f        farmmealplanner_recipes      "java -Djava.securit…"   2 weeks ago         Up 26 hours         8080/tcp                 farmmealplanner_recipes_1
aae136f37e2f        redis                        "docker-entrypoint.s…"   2 weeks ago         Up 26 hours         0.0.0.0:6379-&gt;6379/tcp   farmmealplanner_redis_1
0224e73c6ef9        farmmealplanner_main         "java -Djava.securit…"   2 weeks ago         Up 26 hours         8080/tcp                 farmmealplanner_main_1
</code></pre></div></div>

<p>Navigating to <code>http://localhost</code> brings up the main page. In the annotated image below the content of the browser window comes from three applications running independently from each other in containers. I have marked them up in the image. Red is the navigation UI coming from the navigation application, green is from the recipe application and the rest is from the main application.</p>

<p><img src="/img/posts/2018-04-08-design-for-replaceability/sub_applications.jpg" /></p>

<h2 id="integrating-the-navigation-bar">Integrating the navigation bar</h2>
<p>For simplicity reasons I’m using the Thymeleaf template engine to work with HTML fragements and files to produce the user interface. The main page has a DIV element at the very top and then a SCRIPT block at the bottom.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;body&gt;
  &lt;div id="navigation"&gt;&lt;/div&gt;
  ...
  &lt;script th:include="navigation/topmenu :: topmenu"&gt;&lt;/script&gt;
&lt;/body&gt;
</code></pre></div></div>

<p>The SCRIPT block intents to load the actual navigation bar as a subelement to the DIV with id navigation. If that fails, a static - or hardcoded - version is put there instead.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;script th:fragment="topmenu"&gt;
  $(document).ready(function() {
    $('#navigation').load('/navigation/ #navbar', function(responseText, status){
      if (status !== 'success') {
        $('#navigation').html('&lt;div id="navbar" class="landing_header"&gt;&lt;a href="./"&gt;&lt;img src="http://placehold.it/200x45"/&gt;&lt;/a&gt;&lt;a href="./" class="landing_menu_item"&gt;Home&lt;/a&gt;&lt;/div&gt;');
      }
    });

  });
&lt;/script&gt;
</code></pre></div></div>

<p>That is now an important concept. Let me stay at the topic for while.</p>

<p>The above uses the user’s web browser to integrate the user interface of two separate applications that have independent development and deployment lifecycles. There is a dependency between the main and the navigation application and the dependency can disappear unexpectedly. Somehow the container with the navigation application can stop working. This form of loose coupling creates new problems.</p>

<p>The solution above is to expect failure and be prepared to offer a replacement for the failed component. <strong>Instead of designing for reliability I design for replaceability.</strong> There is a small timeout period when trying to load the menubar from the other application but once it failed to load the replacement menubar looks like this:</p>

<p><img src="/img/posts/2018-04-08-design-for-replaceability/nav_failure.png" /></p>

<p>At the moment I’ve kept it very simple in order to focus on other things. Later on I intent to have a replacement that allows the user to do essential operations.</p>

<h2 id="replace-running-container">Replace running container</h2>
<p>When I want to replace one of the applications during development I simple run <code>mvn install</code> and later use the <code>localrun.sh</code> script:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>22:08 sns ~/dev/farm/farm_meal-planner  (master)$ ./localrun.sh replace recipes
Building recipes
Step 1/5 : FROM openjdk:jdk-alpine
 ---&gt; 3642e636096d
Step 2/5 : MAINTAINER sns@caimito.net
 ---&gt; Using cache
 ---&gt; d2d0bcb7f3bc
Step 3/5 : COPY target/recipes-*.jar /opt/app.jar
 ---&gt; 69efffa29717
Step 4/5 : EXPOSE 8080
 ---&gt; Running in d512abce4ceb
Removing intermediate container d512abce4ceb
 ---&gt; 28f68d399f0c
Step 5/5 : ENTRYPOINT ["java","-Djava.security.egd=file:/dev/./urandom","-jar","/opt/app.jar"]
 ---&gt; Running in a3bf89ffc388
Removing intermediate container a3bf89ffc388
 ---&gt; 85bfeeba927d
Successfully built 85bfeeba927d
Successfully tagged farmmealplanner_recipes:latest
Recreating farmmealplanner_recipes_1 ... done
</code></pre></div></div>

<p>The result is that the running container gets replaced with the freshly build one.</p>

<div class="ale_news_post_footer">
	<h2>Articles in this series</h2>
	<ul>
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
       <li>08 Apr 2018 <a href="/2018/04/08/design-for-replaceability.html">Design for replaceability</a></li>
    
	
     
       <li>07 Apr 2018 <a href="/2018/04/07/draft-of-a-roca-and-scs-style-application.html">Draft of a ROCA- and SCS-style application</a></li>
    
	
     
       <li>02 Apr 2018 <a href="/2018/04/02/considerations-for-a-farm-following-the-principles-of-lean-startup.html">Considerations for a farm following the principles of Lean Startup</a></li>
    
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
     
	
	</ul>
</div>


					<table class="postfooter" style="width: 100%">
					<tr>
						<td style="text-align: left; width: 33%"><a href="/2018/04/07/draft-of-a-roca-and-scs-style-application.html">Previous</a></td>
						<td style="text-align: center; width: 33%">08 Apr 2018</td>
						<td style="text-align: right; width: 33%"><a href="/2018/05/18/how-information-security-can-harm-your-company.html">Next</a></td>
					</tr>
					</table>
					<p>This article has been posted to social media sites. There might be comments. Just follow the links:</p>
					<div>
						<a class="social-blogging" service="twitter" href="https://twitter.com/snscaimito"><img src="/img/Furry-Cushion-Twitter_48.png" /></a>
						<a class="social-blogging" service="activityPub" rel="me" href="https://techhub.social/@snscaimito"><img src="/img/mastodon.svg" width="48" /></a>
					</div>
				</div>
			</div>
			<div class="span3">
        <div class="sidebar">
        	<p class="section">About this article</p>
          <p>Published: April 08, 2018</p>
					<p>Posted in:
						
							<a class="categoryLink" href="/category/software_development.html">software_development</a>
						
					</p>
          
        </div>
				<div class="sidebar">
	<p class="section">About me</p>
	<p>Hello! My name is <a href="/">Stephan Schwab</a>.</p>
			<a href="/"><img src="http://www.gravatar.com/avatar/663d11426b0a187ddac59f8c17ce61b4?s=90" class="align-left"/></a>
		<p>As International Software Development Coach and Consultant I help CEOs and Department Leaders to <strong>improve</strong> <strong>value creation</strong> and <strong>cohesion</strong> within their organization. The outcome will be higher <strong>quality</strong>, <strong>customer delight</strong> and <strong>more revenue</strong>.</p> 
		
		<p>Learn about <a href="/resume/">my professional experience</a> since 1986.</p>
    <span style="clear:both; float:none"/>

	<p class="section">Professional Services</p>
	<p>I'm fluent in these languages:</p>
	<p align="center">
		<a href="/category/en.html"><img src="/img/language-flags/32x32/flag_rotate-02.png"></a>
		<a href="/category/de.html"><img src="/img/language-flags/32x32/flag_rotate-03.png"></a>
		<a href="/category/es.html"><img src="/img/language-flags/32x32/flag_rotate-12.png"></a>
	</p>
	<p align="center">
		<small>
			<a href="/category/en.html">English</a>
			<a href="/category/de.html">German</a>
			<a href="/category/es.html">Spanish</a>
		</small>
	</p>
	<div class="no-print-sidebar">
		<p>Scrum Pair-Coaching to develop technical competence:</p>
		<p align="center">Details in <a href="/en-pair-coaching-scrummaster.html">English</a>, <a
				href="/de-pair-coaching-scrummaster.html">Deutsch</a></p>

		<p><strong>Resources for new clients</strong>:</p>
		<p align="center"><a href="/resources/de-new-client.html">Deutsch</a></p>
	</div>

	<div class="no-print-sidebar">
		<p class="section noprint">Search</p>
		<form method="get" action="http://www.google.com/search">
			<p align="center"><input type="text" name="q" maxlength="255" value="" style="width: 180px" /></br>
				<input type="submit" value="Google Search" class="btn btn-primary btn-mini" />
			</p>
			<input type="hidden" name="sitesearch" value="http://www.stephan-schwab.com" />
		</form>

		<p class="section">Special&nbsp;Content</p>
		<ul class="special-content">
			<li><a href="/atdd/">Acceptance Test-Driven Development</a></li>
			<li><a href="/software-design/">Software Design</a></li>
			<li><a href="/sddm.html">Software Development Decision Making</a></li>
		</ul>
		<ul class="special-content">
			<li><a href="/coaching-future-masters.html">Coaching future masters</a></li>
		</ul>
		<ul class="special-content">
			<li><a href="/farmstead.html">Developing a farmstead in Andalucia, Spain</a></li>
			<li><a href="/house/">Building a house, Spain</a></li>
			<li><a href="/airtravel/">Business travel with light aircraft</a></li>
			<li><a href="/horses/">Horses</a></li>
			<li><a href="/panama-farm.html">Rainforest Farm, Panama</a></li>
			<li><a href="/galleries/">Photo Galleries</a></li>
		</ul>
		<ul class="special-content">
			<li><a href="/reading-list.html">My reading list</a></li>
		</ul>

		<p class="section">Highlights of the Year</p>
		<ul class="special-content">
			
			<li><a href="/2016/12/27/highlights-of-2016.html">2016</a></li>
			
			<li><a href="/2015/12/31/highlights-2015.html">2015</a></li>
			
			<li><a href="/2014/12/31/highlights-2014.html">2014</a></li>
			
			<li><a href="/2013/12/31/hightlights-2013.html">2013</a></li>
			
			<li><a href="/2012/12/31/highlights-2012.html">2012</a></li>
			
			<li><a href="/2011/12/31/highlights-2011.html">2011</a></li>
			
			<li><a href="/2010/12/31/highlights-2010.html">2010</a></li>
			
			<li><a href="/2009/12/31/highlights-2009.html">2009</a></li>
			
			<li><a href="/2008/12/31/highlights-2008.html">2008</a></li>
			
			<li><a href="/2007/12/31/highlights-2007.html">2007</a></li>
			
			<li><a href="/2006/12/31/highlights-2006.html">2006</a></li>
			
		</ul>

		<p class="section">Living on planet Earth</p>
		<ul class="special-content">
			<li><a href="/dominican-republic.html">Dominican Republic</a></li>
			<li><a href="/china.html">China</a></li>
			<li><a href="/germany.html">Germany</a></li>
			<li><a href="/panama.html">Panama</a></li>
			<li><a href="/spain.html">Spain</a></li>
			<li><a href="/usa.html">USA</a></li>
		</ul>

		<p class="section">Open Source Projects</p>
		<ul class="special-content">
			<li><a href="/ale-news.html">Development of ALE News</a></li>
			<li><a href="https://github.com/snscaimito/RAutomation">RAutomation</a></li>
			<li><a href="/open-source.html">Other contributions to Open Source</a></li>
		</ul>

		<p class="section">Stay in touch</p>
		<p align="center">
			<a href="/rss.xml"><img src="/img/Furry-Cushion-RSS_48.png" /></a>
			<a href="https://twitter.com/snscaimito"><img src="/img/Furry-Cushion-Twitter_48.png" /></a>
			<a href="http://www.linkedin.com/in/stephanschwab"><img src="/img/Furry-Cushion-LinkedIn_48.png" /></a>
		</p>
		<p align="center">
			<a rel="me" href="https://techhub.social/@snscaimito"><img src="/img/mastodon.svg" width="48" /></a>
			<a href="https://bsky.app/profile/snscaimito.bsky.social"><img src="/img/Bluesky_butterfly-logo.svg"
					width="65" /></a>
			<a href="https://www.tiktok.com/@snscaimito"><img src="/img/tiktok-icon-white-1-logo-svgrepo-com.svg"
					width="48" /></a>
		</p>
		<p align="center">
			<a href="mailto:sns@caimito.net?subject=From%20stephan-schwab.com">sns@caimito.net</a>
		</p>

		<p class=" section">My Books
		</p>
		<p align="center"><a href="https://leanpub.com/activitycentereddesign"><img
					src="/img/smarter-software-with-activity-centered-design.jpg" /></a></p>
		<p align="center"><a href="https://leanpub.com/essays-on-software-development-2012"><img
					src="/img/essays-on-software-development-2012.png" /></a></p>

		<p class="section">Everything</p>
		<p>See a listing of <a href="/all-posts.html">all posts</a> on this site.</p>
	</div>
</div>
			</div>
		</div>
	</div>
		<script src="//use.typekit.net/npx1yoc.js"></script>
	<script>try{Typekit.load();}catch(e){}</script>
	
	<script type="text/javascript" src="/js/bootstrap.min.js"></script>

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-35257032-1', 'auto');
	  ga('require', 'displayfeatures');
	  ga('send', 'pageview');

	</script>
	<script type="text/javascript"> 
		jQuery(document).ready(function(){ 
			jQuery("#gallery").unitegallery(); 
		}); 
	</script>
	
	<script>
		$(document).ready(function() {
			$('.social-blogging').each(function() {
				const service = $(this).attr('service');
				const url = `/api/posted-on/${service}?article=${window.location.pathname}`;

				fetch(url)
					.then(response => response.json())
					.then(data => {
						console.log(data)
						$(this).attr('href', data.postUrl)
					})
					.catch(error => console.error('Error:', error));
			})
		})
	</script>

</body>
</html>
