<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>First draft of the article service</title>
	
	<link rel="canonical" href="http://0.0.0.0:4000/2014/09/19/first-draft-of-article-service.html"/>
	
	<link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css" />
	<link rel="stylesheet" href="/css/syntax.css" type="text/css" />
	<link rel="stylesheet" href="/css/schwab.css" type="text/css" />
	<link rel="stylesheet" href="/css/print.css" media="print" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans+Condensed|Sansita:700|Zilla+Slab" rel="stylesheet">
	
	<link rel="alternate" type="application/rss+xml" title="Stephan Schwab" href="/rss.xml"/>

	<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>
	<script type='text/javascript' src='/unitegallery/js/unitegallery.min.js'></script> 
		
	<link rel='stylesheet' href='/unitegallery/css/unite-gallery.css' type='text/css' /> 
	<script type='text/javascript' src='/unitegallery/themes/tiles/ug-theme-tiles.js'></script> 

	<meta property="og:title" content="First draft of the article service">
	<meta property="twitter:title" content="First draft of the article service">
	<meta property="og:description" content="">
	<meta property="twitter:description" content="">
	<meta property="og:type" content="article">
	<meta property="og:url" content="http://0.0.0.0:4000/2014/09/19/first-draft-of-article-service.html">
	<meta property="twitter:card" content="summary_large_image">
	<meta property="twitter:site" content="@snscaimito">
	
</head>


<body>
	<div class="container">
		<div class="header no-print">
  <div class="menu">
    <a href="/">Home</a>
    <a href="/category/software_development.html">Software</a>
    <a href="/category/farm-life.html">Farm Life</a>
    <a href="/category/Business.html">Business</a>
    <a href="/category/aviation.html">Aviation</a>
  </div>
  <div class="claim-box">
    <p class="claim">Tales about Aviation, Coaching, Farming, Software Development</p>
  </div>
</div>
		<div class="row">
			<div class="span9">
				<div class="post">
					<h1>First draft of the article service</h1>
          <p>This blog post is part of a series about the development of ALE News using an approach to software development called Acceptance Test-Driven Development. <a href="/ale-news.html">For an overview please see the introductory article</a>.</p>

<h2 id="strict-separation-between-client-and-server">Strict separation between client and server</h2>
<p>Unlike in the past I wanted to use a modern web application architecture. The server should not be concerned with any presentation duties. That means: no HTML will be created on the server. Instead there will be a server application exposing RESTful web services and the actual website will be rendered in the browser - being a pure client consuming the services from the server.</p>

<p>I want to start with a service that allows CRUD operations onto an archive for article metadata.</p>

<h2 id="preliminary-description">Preliminary description</h2>
<p>Before going deep it makes sense to gain a rough overview of the task at hand. What follows is an overview of the planned service to access the archive for article metadata.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Feature: CRUD and list scooped articles
	Scenario: Create new article metadata
	Scenario: Read article metadata
	Scenario: Update article metadata
	Scenario: Delete article metadata
	Scenario: List article metadata
</code></pre></div></div>

<p>With that feature description I outlined <strong>what</strong> my service is going to do.</p>

<h2 id="creating-new-article-metadata">Creating new article metadata</h2>
<p>With that in place I was talking to my self and came up with the following, more detailed, scenario for creating a new entry in the metadata archive.</p>

<p>RESTful web services use HTTP verbs to perform actions onto a resource. A good overview is available at <a href="http://en.wikipedia.org/wiki/Representational_State_Transfer">Wikipedia</a>. To create a new item one sends a POST request to the web service and the service should then return some ID for the newly created item.</p>

<div class="language-gherkin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	<span class="kn">Scenario</span><span class="p">:</span> Create new article metadata
		<span class="nf">When </span>I post the following article metadata to the article service with URI <span class="s">"/article"</span>
			<span class="p">|</span> <span class="nv">Author</span>         <span class="p">|</span> <span class="nv">Title</span>                                            <span class="p">|</span> <span class="nv">location</span>                                                                                                     <span class="p">|</span>
			<span class="p">|</span> <span class="n">Stephan</span> <span class="n">Schwab</span> <span class="p">|</span> <span class="n">From</span> <span class="n">competition</span> <span class="n">it</span> <span class="n">is</span> <span class="n">a</span> <span class="n">big</span> <span class="n">leap</span> <span class="n">to</span> <span class="n">cooperation</span> <span class="p">|</span> <span class="n">http://www.stephan-schwab.com/china/culture/management/thoughts/2014/08/30/collaboration-or-cooperation.html</span> <span class="p">|</span>
		<span class="nf">Then </span>an article ID is returned
		<span class="nf">And </span>the article metadata has been stored in the archive
</code></pre></div></div>

<h2 id="different-views-about-the-what-and-how">Different views about the WHAT and HOW</h2>
<p>I would have written this scenario in a slightly different way:</p>

<div class="language-gherkin highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	<span class="kn">Scenario</span><span class="p">:</span> Create new article metadata
		<span class="nf">When </span>I post the following article metadata to the article service
			<span class="p">|</span> <span class="nv">Author</span>         <span class="p">|</span> <span class="nv">Title</span>                                            <span class="p">|</span> <span class="nv">location</span>                                                                                                     <span class="p">|</span>
			<span class="p">|</span> <span class="n">Stephan</span> <span class="n">Schwab</span> <span class="p">|</span> <span class="n">From</span> <span class="n">competition</span> <span class="n">it</span> <span class="n">is</span> <span class="n">a</span> <span class="n">big</span> <span class="n">leap</span> <span class="n">to</span> <span class="n">cooperation</span> <span class="p">|</span> <span class="n">http://www.stephan-schwab.com/china/culture/management/thoughts/2014/08/30/collaboration-or-cooperation.html</span> <span class="p">|</span>
		<span class="nf">Then </span>an article ID is returned
		<span class="nf">And </span>the article metadata has been stored in the archive
</code></pre></div></div>

<p>The second version is more about <strong>WHAT</strong> the service does and does not give away and details about how to <strong>use</strong> the service. However, when working with a group of developers earlier this year in Berlin I learned that sometimes giving away a little hint isn’t that bad. Those developers wanted to have their scenarios express how to use the service so that the scenarios can be used as some sort of user documentation for those consuming the service. I think that makes sense.</p>

<p>Then I created the necessary boilerplate for <a href="https://github.com/cucumber/cucumber-jvm">Cucumber JVM</a> and provided step definitions for the first two steps of my scenario - just enough to get started.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	<span class="nd">@When</span><span class="o">(</span><span class="s">"^I post the following article metadata to the article service with URI \"(.*?)\"$"</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">postArticle</span><span class="o">(</span><span class="nc">String</span> <span class="n">uri</span><span class="o">,</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ArticleMetadata</span><span class="o">&gt;</span> <span class="n">metadata</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>
		<span class="n">expectedMetadata</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
		<span class="n">actualArticleId</span> <span class="o">=</span> <span class="nc">ClientBuilder</span><span class="o">.</span><span class="na">newClient</span><span class="o">()</span>
	            <span class="o">.</span><span class="na">target</span><span class="o">(</span><span class="s">"http://localhost:8080/article-service"</span><span class="o">).</span><span class="na">path</span><span class="o">(</span><span class="n">uri</span><span class="o">)</span>
	            <span class="o">.</span><span class="na">request</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON_TYPE</span><span class="o">).</span><span class="na">post</span><span class="o">(</span><span class="nc">Entity</span><span class="o">.</span><span class="na">entity</span><span class="o">(</span><span class="n">expectedMetadata</span><span class="o">,</span> <span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">))</span>
	            <span class="o">.</span><span class="na">readEntity</span><span class="o">(</span><span class="nc">ArticleId</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
	<span class="o">}</span>
	
	<span class="nd">@Then</span><span class="o">(</span><span class="s">"^an article ID is returned$"</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">an_article_ID_is_returned</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>
		<span class="n">assertThat</span><span class="o">(</span><span class="n">actualArticleId</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="n">is</span><span class="o">(</span><span class="n">notNullValue</span><span class="o">()))</span> <span class="o">;</span>
	<span class="o">}</span>
</code></pre></div></div>

<p>The Java step definition contains a number of technical details. Those are clearly about <strong>how to use</strong> the service and should definitely not be in the scenario description.</p>

<p>The data format used by consumer and service is JSON. In the request the client is asking for JSON data: <code>request(MediaType.APPLICATION_JSON_TYPE)</code>. It is also sending the encoded entity (the article metadata) as JSON: <code>post(Entity.entity(expectedMetadata, MediaType.APPLICATION_JSON))</code></p>

<h2 id="time-to-write-some-production-code">Time to write some production code</h2>
<p>With that in place I needed to write just enough code to at least get to the <em>Then an article ID is returned</em> step. So I wrote this:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
	<span class="nd">@Path</span><span class="o">(</span><span class="s">"article"</span><span class="o">)</span>
	<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ArticleResource</span> <span class="o">{</span>
		<span class="c1">// todo: fake</span>
		<span class="kd">private</span> <span class="kd">static</span> <span class="nc">ArticleMetadata</span> <span class="n">fakeArticle</span> <span class="o">;</span>
		
	    <span class="nd">@POST</span>
	    <span class="nd">@Produces</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
	    <span class="nd">@Consumes</span><span class="o">(</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON</span><span class="o">)</span>
	    <span class="kd">public</span> <span class="nc">ArticleId</span> <span class="nf">storeArticle</span><span class="o">(</span><span class="nc">ArticleMetadata</span> <span class="n">metadata</span><span class="o">)</span> <span class="o">{</span>
	    	<span class="nc">ArticleId</span> <span class="n">id</span> <span class="o">=</span> <span class="nc">ArticleId</span><span class="o">.</span><span class="na">generate</span><span class="o">()</span> <span class="o">;</span>
	    	<span class="n">fakeArticle</span> <span class="o">=</span> <span class="n">metadata</span> <span class="o">;</span>
	        <span class="n">fakeArticle</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">id</span><span class="o">.</span><span class="na">getId</span><span class="o">())</span> <span class="o">;</span>
	        <span class="k">return</span> <span class="n">id</span> <span class="o">;</span>
	    <span class="o">}</span>
		
	<span class="o">}</span>
</code></pre></div></div>
<h2 id="no-storage-facility-needed-at-this-point">No storage facility needed at this point</h2>
<p>Note that I’m using a static variable to hold the article metadata posted to the service.</p>

<p>Unlike other approaches, I want to focus on the behavior of the service and not spend time thinking about how the service will perform it’s work on the inside. There will be a time for that later on. At the moment I feel that for the new version of <a href="http://www.ale-news.com">ALE News</a> I need the ability to somehow store and retrieve article metadata but there is certainly a lot more than just that. I want to explore those other things first a bit before spending time and effort on fleshing out a service that I might need to change substantially or replace with something else soon.</p>

<p>After all, software product development is a journey and you never know what you will discover.</p>

<div class="ale_news_post_footer">
	<h2>More in this series</h2>
	<ul>
	
		 <li>03 Nov 2014 <a href="/2014/11/03/selecting-a-test-and-automation-tool-for-ios.html">Selecting a test and automation tool for IOS</a></li>
	
		 <li>27 Oct 2014 <a href="/2014/10/27/making-my-IOS-world-a-better-place.html">Making my IOS world a better place</a></li>
	
		 <li>19 Oct 2014 <a href="/2014/10/19/making-the-world.html">Making the world</a></li>
	
		 <li>14 Oct 2014 <a href="/2014/10/14/scenarios-that-depend-on-each-other-are-bad.html">Scenarios that depend on each other are bad</a></li>
	
		 <li>10 Oct 2014 <a href="/2014/10/10/improving-the-fake-storage.html">Improving the fake storage</a></li>
	
		 <li>29 Sep 2014 <a href="/2014/09/29/how-to-verify-things.html">How to verify things</a></li>
	
		 <li>27 Sep 2014 <a href="/2014/09/27/what-should-ale-news-web-client-do.html">What should the ALE News web client do?</a></li>
	
		 <li>26 Sep 2014 <a href="/2014/09/26/selecting-tools-for-testing-the-web-client.html">Selecting tools for testing the web client</a></li>
	
		 <li>25 Sep 2014 <a href="/2014/09/25/learning-angularjs-to-create-the-ale-news-web-client.html">Learning AngularJS to create the ALE News web client</a></li>
	
		 <li>24 Sep 2014 <a href="/2014/09/24/adding-web-client.html">Adding the web client module</a></li>
	
		 <li>23 Sep 2014 <a href="/2014/09/23/single-command-build.html">Build with a single command</a></li>
	
		 <li>19 Sep 2014 <a href="/2014/09/19/first-draft-of-article-service.html">First draft of the article service</a></li>
	
	</ul>
</div>


					<table class="postfooter" style="width: 100%">
					<tr>
						<td style="text-align: left; width: 33%"><a href="/2014/09/18/is-uncovering-issues-an-issue.html">Previous</a></td>
						<td style="text-align: center; width: 33%">19 Sep 2014</td>
						<td style="text-align: right; width: 33%"><a href="/2014/09/19/night-shadows.html">Next</a></td>
					</tr>
					</table>
					<p>This article has been posted to social media sites. There might be comments. Just follow the links:</p>
					<div>
						<a class="social-blogging" service="twitter" href="https://twitter.com/snscaimito"><img src="/img/Furry-Cushion-Twitter_48.png" /></a>
						<a class="social-blogging" service="activityPub" rel="me" href="https://techhub.social/@snscaimito"><img src="/img/mastodon.svg" width="48" /></a>
					</div>
				</div>
			</div>
			<div class="span3">
        <div class="sidebar">
        	<p class="section">About this article</p>
          <p>Published: September 19, 2014</p>
					<p>Posted in:
						
							<a class="categoryLink" href="/category/atdd.html">atdd</a>
						
							<a class="categoryLink" href="/category/software_development.html">software_development</a>
						
					</p>
          
        </div>
				<div class="sidebar">
	<p class="section">About me</p>
	<p>Hello! My name is <a href="/">Stephan Schwab</a>.</p>
			<a href="/"><img src="http://www.gravatar.com/avatar/663d11426b0a187ddac59f8c17ce61b4?s=90" class="align-left"/></a>
		<p>As International Software Development Coach and Consultant I help CEOs and Department Leaders to <strong>improve</strong> <strong>value creation</strong> and <strong>cohesion</strong> within their organization. The outcome will be higher <strong>quality</strong>, <strong>customer delight</strong> and <strong>more revenue</strong>.</p> 
		
		<p>Learn about <a href="/resume/">my professional experience</a> since 1986.</p>
    <span style="clear:both; float:none"/>

	<p class="section">Professional Services</p>
	<p>I'm fluent in these languages:</p>
	<p align="center">
		<a href="/category/en.html"><img src="/img/language-flags/32x32/flag_rotate-02.png"></a>
		<a href="/category/de.html"><img src="/img/language-flags/32x32/flag_rotate-03.png"></a>
		<a href="/category/es.html"><img src="/img/language-flags/32x32/flag_rotate-12.png"></a>
	</p>
	<p align="center">
		<small>
			<a href="/category/en.html">English</a>
			<a href="/category/de.html">German</a>
			<a href="/category/es.html">Spanish</a>
		</small>
	</p>
	<div class="no-print-sidebar">
		<p>Scrum Pair-Coaching to develop technical competence:</p>
		<p align="center">Details in <a href="/en-pair-coaching-scrummaster.html">English</a>, <a
				href="/de-pair-coaching-scrummaster.html">Deutsch</a></p>

		<p><strong>Resources for new clients</strong>:</p>
		<p align="center"><a href="/resources/de-new-client.html">Deutsch</a></p>
	</div>

	<div class="no-print-sidebar">
		<p class="section noprint">Search</p>
		<form method="get" action="http://www.google.com/search">
			<p align="center"><input type="text" name="q" maxlength="255" value="" style="width: 180px" /></br>
				<input type="submit" value="Google Search" class="btn btn-primary btn-mini" />
			</p>
			<input type="hidden" name="sitesearch" value="http://www.stephan-schwab.com" />
		</form>

		<p class="section">Special&nbsp;Content</p>
		<ul class="special-content">
			<li><a href="/atdd/">Acceptance Test-Driven Development</a></li>
			<li><a href="/software-design/">Software Design</a></li>
			<li><a href="/sddm.html">Software Development Decision Making</a></li>
		</ul>
		<ul class="special-content">
			<li><a href="/coaching-future-masters.html">Coaching future masters</a></li>
		</ul>
		<ul class="special-content">
			<li><a href="/farmstead.html">Developing a farmstead in Andalucia, Spain</a></li>
			<li><a href="/house/">Building a house, Spain</a></li>
			<li><a href="/airtravel/">Business travel with light aircraft</a></li>
			<li><a href="/horses/">Horses</a></li>
			<li><a href="/panama-farm.html">Rainforest Farm, Panama</a></li>
			<li><a href="/galleries/">Photo Galleries</a></li>
		</ul>
		<ul class="special-content">
			<li><a href="/reading-list.html">My reading list</a></li>
		</ul>

		<p class="section">Highlights of the Year</p>
		<ul class="special-content">
			
			<li><a href="/2016/12/27/highlights-of-2016.html">2016</a></li>
			
			<li><a href="/2015/12/31/highlights-2015.html">2015</a></li>
			
			<li><a href="/2014/12/31/highlights-2014.html">2014</a></li>
			
			<li><a href="/2013/12/31/hightlights-2013.html">2013</a></li>
			
			<li><a href="/2012/12/31/highlights-2012.html">2012</a></li>
			
			<li><a href="/2011/12/31/highlights-2011.html">2011</a></li>
			
			<li><a href="/2010/12/31/highlights-2010.html">2010</a></li>
			
			<li><a href="/2009/12/31/highlights-2009.html">2009</a></li>
			
			<li><a href="/2008/12/31/highlights-2008.html">2008</a></li>
			
			<li><a href="/2007/12/31/highlights-2007.html">2007</a></li>
			
			<li><a href="/2006/12/31/highlights-2006.html">2006</a></li>
			
		</ul>

		<p class="section">Living on planet Earth</p>
		<ul class="special-content">
			<li><a href="/dominican-republic.html">Dominican Republic</a></li>
			<li><a href="/china.html">China</a></li>
			<li><a href="/germany.html">Germany</a></li>
			<li><a href="/panama.html">Panama</a></li>
			<li><a href="/spain.html">Spain</a></li>
			<li><a href="/usa.html">USA</a></li>
		</ul>

		<p class="section">Open Source Projects</p>
		<ul class="special-content">
			<li><a href="/ale-news.html">Development of ALE News</a></li>
			<li><a href="https://github.com/snscaimito/RAutomation">RAutomation</a></li>
			<li><a href="/open-source.html">Other contributions to Open Source</a></li>
		</ul>

		<p class="section">Stay in touch</p>
		<p align="center">
			<a href="/rss.xml"><img src="/img/Furry-Cushion-RSS_48.png" /></a>
			<a href="https://twitter.com/snscaimito"><img src="/img/Furry-Cushion-Twitter_48.png" /></a>
			<a href="http://www.linkedin.com/in/stephanschwab"><img src="/img/Furry-Cushion-LinkedIn_48.png" /></a>
		</p>
		<p align="center">
			<a rel="me" href="https://techhub.social/@snscaimito"><img src="/img/mastodon.svg" width="48" /></a>
			<a href="https://bsky.app/profile/snscaimito.bsky.social"><img src="/img/Bluesky_butterfly-logo.svg"
					width="65" /></a>
			<a href="https://www.tiktok.com/@snscaimito"><img src="/img/tiktok-icon-white-1-logo-svgrepo-com.svg"
					width="48" /></a>
		</p>
		<p align="center">
			<a href="mailto:sns@caimito.net?subject=From%20stephan-schwab.com">sns@caimito.net</a>
		</p>

		<p class=" section">My Books
		</p>
		<p align="center"><a href="https://leanpub.com/activitycentereddesign"><img
					src="/img/smarter-software-with-activity-centered-design.jpg" /></a></p>
		<p align="center"><a href="https://leanpub.com/essays-on-software-development-2012"><img
					src="/img/essays-on-software-development-2012.png" /></a></p>

		<p class="section">Everything</p>
		<p>See a listing of <a href="/all-posts.html">all posts</a> on this site.</p>
	</div>
</div>
			</div>
		</div>
	</div>
		<script src="//use.typekit.net/npx1yoc.js"></script>
	<script>try{Typekit.load();}catch(e){}</script>
	
	<script type="text/javascript" src="/js/bootstrap.min.js"></script>

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-35257032-1', 'auto');
	  ga('require', 'displayfeatures');
	  ga('send', 'pageview');

	</script>
	<script type="text/javascript"> 
		jQuery(document).ready(function(){ 
			jQuery("#gallery").unitegallery(); 
		}); 
	</script>
	
	<script>
		$(document).ready(function() {
			$('.social-blogging').each(function() {
				const service = $(this).attr('service');
				const url = `/api/posted-on/${service}?article=${window.location.pathname}`;

				fetch(url)
					.then(response => response.json())
					.then(data => {
						console.log(data)
						$(this).attr('href', data.postUrl)
					})
					.catch(error => console.error('Error:', error));
			})
		})
	</script>

</body>
</html>
